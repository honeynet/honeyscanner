{
  "Release_0.6.0": {
    "summary": {
      "high_severity": 4,
      "medium_severity": 24
    },
    "results": [
      {
        "code": "157 \n158     parsed_xml = xml.dom.minidom.parseString(config_xml)\n159     pretty_xml = parsed_xml.toprettyxml()\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/bin/kamstrup_prober.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Using xml.dom.minidom.parseString to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.dom.minidom.parseString with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called",
        "line_number": 158,
        "line_range": [
          158
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-xml-bad-minidom",
        "test_id": "B318",
        "test_name": "blacklist"
      },
      {
        "code": "78         logger.debug('Initializing databus using %s.', config_file)\n79         dom = etree.parse(config_file)\n80         entries = dom.xpath('//core/databus/key_value_mappings/*')\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/core/databus.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.",
        "line_number": 79,
        "line_range": [
          79
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-xml-bad-etree",
        "test_id": "B320",
        "test_name": "blacklist"
      },
      {
        "code": "87             if value_type == 'value':\n88                 self.set_value(key, eval(value))\n89             elif value_type == 'function':\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/core/databus.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Use of possibly insecure function - consider using safer ast.literal_eval.",
        "line_number": 88,
        "line_range": [
          88
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b307-eval",
        "test_id": "B307",
        "test_name": "blacklist"
      },
      {
        "code": "95                     # eval param to list\n96                     params = eval(params[0])\n97                     self.set_value(key, _class(*(tuple(params))))\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/core/databus.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Use of possibly insecure function - consider using safer ast.literal_eval.",
        "line_number": 96,
        "line_range": [
          96
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b307-eval",
        "test_id": "B307",
        "test_name": "blacklist"
      },
      {
        "code": "76             secret = config.get('hpfriends', 'secret')\n77             channels = eval(config.get('hpfriends', 'channels'))\n78             try:\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/core/loggers/log_worker.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Use of possibly insecure function - consider using safer ast.literal_eval.",
        "line_number": 77,
        "line_range": [
          77
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b307-eval",
        "test_id": "B307",
        "test_name": "blacklist"
      },
      {
        "code": "30         self.registers = {}\n31         dom = etree.parse(template)\n32         categories = dom.xpath('//IEC104/categories/*')\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/protocols/IEC104/DeviceDataController.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.",
        "line_number": 31,
        "line_range": [
          31
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b313-b320-xml-bad-etree",
        "test_id": "B320",
        "test_name": "blacklist"
      },
      {
        "code": "40     def __init__(self, template, template_directory, args):\n41         self.dom = etree.parse(template)\n42         device_info_root = self.dom.xpath('//bacnet/device_info')[0]\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/protocols/bacnet/bacnet_server.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.",
        "line_number": 41,
        "line_range": [
          41
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b313-b320-xml-bad-etree",
        "test_id": "B320",
        "test_name": "blacklist"
      },
      {
        "code": "55     def parse_template(self):\n56         dom = etree.parse(self.template)\n57         self.server_addr    = dom.xpath('//enip/@host')[0]\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/protocols/enip/enip_server.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.",
        "line_number": 56,
        "line_range": [
          56
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b313-b320-xml-bad-etree",
        "test_id": "B320",
        "test_name": "blacklist"
      },
      {
        "code": "36         self.grp_db = dict()   # grp_db[gid] = {group: 'group_name'. users: set(users_uid))\n37         dom = etree.parse(template)\n38         # First let us get FTP related data\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/protocols/ftp/ftp_server.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.",
        "line_number": 37,
        "line_range": [
          37
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b313-b320-xml-bad-etree",
        "test_id": "B320",
        "test_name": "blacklist"
      },
      {
        "code": "971                     try:\n972                         result = eval(key)\n973                     except Exception as e:\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/protocols/http/command_responder.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Use of possibly insecure function - consider using safer ast.literal_eval.",
        "line_number": 972,
        "line_range": [
          972
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b307-eval",
        "test_id": "B307",
        "test_name": "blacklist"
      },
      {
        "code": "1000         # for the first time in order to reduce further handling..\n1001         self.configuration = etree.parse(template)\n1002 \n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/protocols/http/command_responder.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.",
        "line_number": 1001,
        "line_range": [
          1001
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b313-b320-xml-bad-etree",
        "test_id": "B320",
        "test_name": "blacklist"
      },
      {
        "code": "30 import hashlib\n31 from Crypto.Cipher import AES\n32 \n33 logger = logging.getLogger(__name__)\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/protocols/ipmi/fakesession.py",
        "issue_confidence": "HIGH",
        "issue_severity": "HIGH",
        "issue_text": "The pyCrypto library and its module AES are no longer actively maintained and have been deprecated. Consider using pyca/cryptography library.",
        "line_number": 31,
        "line_range": [
          31,
          32
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b413-import-pycrypto",
        "test_id": "B413",
        "test_name": "blacklist"
      },
      {
        "code": "43     def __init__(self, template, template_directory, args):\n44         dom = etree.parse(template)\n45         databus = conpot_core.get_databus()\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/protocols/ipmi/ipmi_server.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.",
        "line_number": 44,
        "line_range": [
          44
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b313-b320-xml-bad-etree",
        "test_id": "B320",
        "test_name": "blacklist"
      },
      {
        "code": "33 \n34         dom = etree.parse(template)\n35         registers = dom.xpath('//kamstrup_meter/registers/*')\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/protocols/kamstrup/meter_protocol/command_responder.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.",
        "line_number": 34,
        "line_range": [
          34
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b313-b320-xml-bad-etree",
        "test_id": "B320",
        "test_name": "blacklist"
      },
      {
        "code": "49     def _get_mode_and_delay(self, template):\n50         dom = etree.parse(template)\n51         self.mode = dom.xpath('//modbus/mode/text()')[0].lower()\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/protocols/modbus/modbus_server.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.",
        "line_number": 50,
        "line_range": [
          50
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b313-b320-xml-bad-etree",
        "test_id": "B320",
        "test_name": "blacklist"
      },
      {
        "code": "63     def _configure_slaves(self, template):\n64         dom = etree.parse(template)\n65         slaves = dom.xpath('//modbus/slaves/*')\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/protocols/modbus/modbus_server.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.",
        "line_number": 64,
        "line_range": [
          64
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b313-b320-xml-bad-etree",
        "test_id": "B320",
        "test_name": "blacklist"
      },
      {
        "code": "72                     name = b.attrib['name']\n73                     request_type = eval('mdef.' + b.xpath('./type/text()')[0])\n74                     start_addr = int(b.xpath('./starting_address/text()')[0])\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/protocols/modbus/modbus_server.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Use of possibly insecure function - consider using safer ast.literal_eval.",
        "line_number": 73,
        "line_range": [
          73
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b307-eval",
        "test_id": "B307",
        "test_name": "blacklist"
      },
      {
        "code": "23         Databank.__init__(self)\n24         self.dom = etree.parse(template)\n25 \n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/protocols/modbus/slave_db.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.",
        "line_number": 24,
        "line_range": [
          24
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b313-b320-xml-bad-etree",
        "test_id": "B320",
        "test_name": "blacklist"
      },
      {
        "code": "49         self.start_time = None  # Initialize later\n50         dom = etree.parse(template)\n51 \n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/protocols/s7comm/s7_server.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.",
        "line_number": 50,
        "line_range": [
          50
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b313-b320-xml-bad-etree",
        "test_id": "B320",
        "test_name": "blacklist"
      },
      {
        "code": "41 \n42         self.dom = etree.parse(template)\n43         self.cmd_responder = None\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/protocols/snmp/snmp_server.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.",
        "line_number": 42,
        "line_range": [
          42
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b313-b320-xml-bad-etree",
        "test_id": "B320",
        "test_name": "blacklist"
      },
      {
        "code": "60     def _init_vfs(self, template):\n61         dom = etree.parse(template)\n62         self.root_path = dom.xpath('//tftp/tftp_root_path/text()')[0].lower()\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/protocols/tftp/tftp_server.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.",
        "line_number": 61,
        "line_range": [
          61
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b313-b320-xml-bad-etree",
        "test_id": "B320",
        "test_name": "blacklist"
      },
      {
        "code": "28 from conpot.protocols.ftp.ftp_server import FTPServer\n29 import ftplib      # Use ftplib's client for more authentic testing\n30 \n31 \n32 class TestFTPServer(unittest.TestCase):\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/tests/test_ftp.py",
        "issue_confidence": "HIGH",
        "issue_severity": "HIGH",
        "issue_text": "A FTP-related module is being imported.  FTP is considered insecure. Use SSH/SFTP/SCP or some other encrypted protocol.",
        "line_number": 29,
        "line_range": [
          29,
          30,
          31
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b402-import-ftplib",
        "test_id": "B402",
        "test_name": "blacklist"
      },
      {
        "code": "47         self.server_greenlet = gevent.spawn(self.ftp_server.start, '127.0.0.1', 0)\n48         self.client = ftplib.FTP()\n49         gevent.sleep(1)\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/tests/test_ftp.py",
        "issue_confidence": "HIGH",
        "issue_severity": "HIGH",
        "issue_text": "FTP-related functions are being called. FTP is considered insecure. Use SSH/SFTP/SCP or some other encrypted protocol.",
        "line_number": 48,
        "line_range": [
          48
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b321-ftplib",
        "test_id": "B321",
        "test_name": "blacklist"
      },
      {
        "code": "66             del self.client\n67         self.client = ftplib.FTP()\n68         self.client.connect(host='127.0.0.1', port=self.ftp_server.server.server_port)\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/tests/test_ftp.py",
        "issue_confidence": "HIGH",
        "issue_severity": "HIGH",
        "issue_text": "FTP-related functions are being called. FTP is considered insecure. Use SSH/SFTP/SCP or some other encrypted protocol.",
        "line_number": 67,
        "line_range": [
          67
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b321-ftplib",
        "test_id": "B321",
        "test_name": "blacklist"
      },
      {
        "code": "66         # retrieve configuration from xml\n67         dom = etree.parse(self.dir_name + '/templates/default/template.xml')\n68 \n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/tests/test_http_server.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.",
        "line_number": 67,
        "line_range": [
          67
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b313-b320-xml-bad-etree",
        "test_id": "B320",
        "test_name": "blacklist"
      },
      {
        "code": "87         # retrieve configuration from xml\n88         dom = etree.parse(self.dir_name + '/templates/default/http/http.xml')\n89 \n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/tests/test_http_server.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.",
        "line_number": 88,
        "line_range": [
          88
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b313-b320-xml-bad-etree",
        "test_id": "B320",
        "test_name": "blacklist"
      },
      {
        "code": "50                                1: {'request': 'give me apples', 'response': 'no way'}}}\n51         dom = etree.parse('conpot/templates/default/template.xml')\n52         stixTransformer = StixTransformer(config, dom)\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/tests/test_taxii.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.",
        "line_number": 51,
        "line_range": [
          51
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b313-b320-xml-bad-etree",
        "test_id": "B320",
        "test_name": "blacklist"
      },
      {
        "code": "84                                1: {'request': 'give me apples', 'response': 'no way'}}}\n85         dom = etree.parse('conpot/templates/default/template.xml')\n86         taxiiLogger = TaxiiLogger(config, dom)\n",
        "filename": "/home/kali/thesis/honeyscanner/honeyscanner/passive_attacks/static_analyzer/conpot-Release_0.6.0/conpot/tests/test_taxii.py",
        "issue_confidence": "HIGH",
        "issue_severity": "MEDIUM",
        "issue_text": "Using lxml.etree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace lxml.etree.parse with its defusedxml equivalent function.",
        "line_number": 85,
        "line_range": [
          85
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b313-b320-xml-bad-etree",
        "test_id": "B320",
        "test_name": "blacklist"
      }
    ]
  }
}